

晨星的算法：

是一个Daily盈亏的算法

**适用于**:

场内期货、期权. (场外的也许也适合，再想一下。)

#### Daily盈亏由两部分组成:
今日持仓盈亏  +  成交产生的盈亏

1. 不看持仓明细，直接看今日总持仓

对于总持仓里的每一条目，  用  (今收盘价 - 昨收盘价) \* vol \* multi \*(买为1；卖为-1)

2. 看今日成交单
对于成交单里面的每一条目

买入: 用 （-1）\*(成交价 - 昨收盘价) \* vol \* multi ; 

卖出: 用 （ 1）\*(成交价 - 昨收盘价) \* vol \* multi ; 


3. 为什么是这样呢， 请看表格:

| h1   | h2   | h3   | h4   |
|------|------|------|------|
|持仓  | 多(1) |  今收 - 昨收  |
|      | 空(-1)|  今收 - 昨收  |
|买开| (成交-昨收)\*(-1)| 卖开| (成交-昨收)\*(1)|
|卖平| (成交-昨收)\*(1) | 买平| (成交-昨收)\*(-1)|



此方法的**高明之处**在于:

(1) 不依赖平仓盈亏明细表。不区分平今、平昨;也不依赖开仓日期字段。

(2) 也不依赖持仓明细表。 不区分开仓日期是不是今天

(3) 计算的基础为:

当日持仓汇总，  当日成交明细


#### 另外一种算法

可以看作是上述算法的变形。[可上述算法的结果是一样的。]

计算的基础为:

昨日持仓汇总,   当日成交明细


1, 从昨日总持仓出发，

对于昨日总持仓里的每一条目，用 (今收盘价 - 昨收盘价) \* vol \* multi \* (买为1， 卖为-1)

2，看今日成交单

对于今日成交单中的每一条目

买入:   用 ( 1) \* (今收盘价 - 今成交价) \* vol \* multi

卖出：  用 (-1) \* (今收盘价 - 今成交价) \* vol \* multi

3, 请看分析表格:

| h1   | h2   | h3   | h4   |
|------|------|------|------|
|买开| (今收-成交)\*(1)| 卖开| (今收-成交)\*(-1)|
|卖平| (今收-成交)\*(-1) | 买平| (今收-成交)\*(1)|


4, 汇总

持仓浮动盈亏 + 成交盈亏



